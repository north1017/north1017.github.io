<html>
<head>
  <meta charset="utf-8">
  <title>ã½ã¡ã‚ƒã£ã“ã«è³ªå•</title>
</head>
<style>
	body{
		background-image: url(images3/hai.png);
		text-align: center;
		font-family: "æ¸¸ã‚´ã‚·ãƒƒã‚¯ä½“", "Yu Gothic", YuGothic, "ãƒ’ãƒ©ã‚®ãƒè§’ã‚´ Pro", "Hiragino Kaku Gothic Pro", "ãƒ¡ã‚¤ãƒªã‚ª", "Meiryo", sans-serif;
		font-size: 1.5em;
	}
	#box{
		margin: 50px 100px 50px 100px;
	}
	#a{
		font-size: 15px;
	}
    #b{
		font-size: 13px;
	}
	.center-box {
    	text-align:center;
		margin-bottom: 150px;
  }
</style>
<body>
<div id="box">
<div class="center-box">
	<img id="mic" src="images3/cat.png" width=250px align="left">
		<p><br>ã½ã¡ã‚ƒã£ã“ã«è§¦ã£ã¦ã‹ã‚‰<br>è³ªå•ã—ã¦ã­</p>
		<p id="a">ã½ã¡ã‚ƒã£ã“ãŒç­”ãˆã‚‰ã‚Œã‚‹ã“ã¨ã¯ã€<br>å‹•ç”»ã€å¤§å¦»å¥³å­å¤§å­¦ã®åœ°å›³ã€2.5æ¬¡å…ƒèˆå°ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã€å£°å„ªã®ã‚¤ãƒ™ãƒ³ãƒˆæƒ…å ±ã«ã¤ã„ã¦ã ã‚ˆï¼</p>
        <p id="b">ä¸Šã®è¨€è‘‰ã«ã—ã‹åå¿œã—ã¾ã›ã‚“...ğŸ’¦</p>
		<div id="result-div" class="large-text">ä½•ã‚’èãï¼Ÿ</div>
	</div>
	<div id="content"></div>
</div>
<script>
  const resultDiv = document.querySelector('#result-div');
  const micDiv = document.querySelector('#mic');
	
  let speakingtime = 0;
  
  // éŸ³å£°èªè­˜æ©Ÿèƒ½(Chrome)
  let rec = new webkitSpeechRecognition();
  let stopped = true;
  rec.continuous = true;
  rec.interimResults = false;
  rec.lang = 'ja-JP';

  micDiv.onclick = function () {
    if (stopped == true) {
      stopped = false;
      resultDiv.innerHTML = "";
      rec.start();
    } else {
      stopped = true;
      rec.stop();
    }
  }

  rec.onstart = function () {
    console.log('on start');
    micDiv.setAttribute("src","images3/cat.png");
    speakingtime = 0;
  };

  rec.onend = function () {
    console.log('on end');
    micDiv.setAttribute("src","images3/cat.png");
    if (stopped == false) {
      setTimeout(function () {
        rec.start();
      },speakingtime);
    }
  };

  rec.onresult = function (e) {
    rec.stop();
    for (let i = e.resultIndex; i < e.results.length; i++) {
      if (e.results[i].isFinal) {
        console.log(e);
        let text = e.results[i][0].transcript;
  switch(text) {
    case "å‹•ç”»":
      getVideo();
      break;
    case "å¤§å¦»å¥³å­å¤§å­¦ã®åœ°å›³":
      getMap();
      break;
    case "2.5æ¬¡å…ƒèˆå°ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«":
      getMusicalInfo();
      break;
	  case "å£°å„ªã®ã‚¤ãƒ™ãƒ³ãƒˆæƒ…å ±":
      getVoiceActorEvent();
      break;
    default:
      getTextContents(text);
  }
        console.log(text);
        speakingtime = text.length * 200;
        console.log("estimate:", speakingtime, "ms");
//        speak(text);
        resultDiv.innerHTML = text;
      }
    }
  }


//ãƒ“ãƒ‡ã‚ª
function getVideo() {
    var URL = '<iframe width="560" height="315" src="https://www.youtube.com/embed/aoCPwWt_wr4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>';
    
    content.innerHTML = URL;
}

//ãƒ©ã‚¸ã‚ª
function getMap() {
  var URL = '<iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3240.4272684186103!2d139.74102421470403!3d35.691101937039136!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x60188c68c884a9f3%3A0x5940dbc0a22ff46e!2z5aSn5aa75aWz5a2Q5aSn5a2m!5e0!3m2!1sja!2sjp!4v1574151334930!5m2!1sja!2sjp" width="600" height="450" frameborder="0" style="border:0;" allowfullscreen=""></iframe>';
  
  content.innerHTML = URL;
}

//2.5æ¬¡å…ƒèˆå°
function getMusicalInfo() {
    var iframe = document.createElement('iframe');
    
    iframe.width = '400px';
    iframe.height = '400px';
    iframe.src = 'https://www.j25musical.jp/stage/';
    content.appendChild(iframe);
  }
function getVoiceActorEvent() {
    var iframe = document.createElement('iframe');
    
    iframe.width = '400px';
    iframe.height = '400px';
    iframe.src = 'https://t.pia.jp/pia/tag/tag.do?tagCd=0000037';
    content.appendChild(iframe);
  }

  
	
  // ç™ºè©±æ©Ÿèƒ½ã‚’ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–
  let msg = new SpeechSynthesisUtterance();
  let voices = window.speechSynthesis.getVoices();

  function speak(text) {
    // ä»¥ä¸‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³è¨­å®šï¼ˆæ—¥æœ¬èªã¯åŠ¹ã‹ãªã„ã‚‚ã‚ˆã†ã€‚ã€‚ï¼‰
    msg.voice = voices[7]; // 7:Google æ—¥æœ¬äºº ja-JP â€»ä»–ã¯è‹±èªã®ã¿
    msg.volume = 1.0; // éŸ³é‡ min 0 ~ max 1
    msg.rate = 1.0; // é€Ÿåº¦ min 0 ~ max 10
    msg.pitch = 1.0; // éŸ³ç¨‹ min 0 ~ max 2

    msg.text = text; // å–‹ã‚‹å†…å®¹
    msg.lang = 'ja-JP'; // en-US or ja-JP
    // msg.lang = 'en-US'; // en-US or ja-JP

    // ç™ºè©±å®Ÿè¡Œ
    speechSynthesis.speak(msg);
  }
  
  // çµ‚äº†æ™‚ã®å‡¦ç†
  msg.onend = function (event) {
    console.log('å–‹ã£ãŸæ™‚é–“ï¼š' + event.elapsedTime + 'ms');
  }


</script>
</body>
</html>